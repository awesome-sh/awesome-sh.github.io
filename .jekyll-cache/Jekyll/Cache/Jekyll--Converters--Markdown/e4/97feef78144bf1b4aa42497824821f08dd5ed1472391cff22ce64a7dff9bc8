I"	<p>Ajax 비동기통신을 사용해 엑셀파일업로드 후 Controller에서 엑셀데이터를 파싱해보자</p>

<p>업로드가 필요한 페이지 html파일에 아래와 같이 Form과 Input[type=file]을 만들어 줍니다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;form id="uploadFrm" enctype="multipart/form-data"&gt;
  &lt;p&gt;데이터 업로드&lt;br&gt;엑셀파일만 업로드 가능(xls, xlsx)&lt;/p&gt;
  &lt;input type="file" name="upFile" id="upFile" accept=".xlsx, .xls"/&gt;
&lt;/form&gt;
</code></pre></div></div>

<hr />

<p>index.html 파일 내 &lt;head&gt;와 &lt;/head&gt; 사이 아래 코드를 삽입해주세요</p>

<p>아래 태그가 CDN 방식으로 Openlayers를 적용하고 Import 하는 방법입니다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;!-- OpenLayers CDN --&gt;
&lt;script src="https://cdn.rawgit.com/openlayers/openlayers.github.io/master/en/v6.1.1/build/ol.js"&gt;&lt;/script&gt;
&lt;link rel="stylesheet" href="https://cdn.rawgit.com/openlayers/openlayers.github.io/master/en/v6.1.1/css/ol.css"&gt;

&lt;!-- Index CSS 지도에 스타일들을 관리하기 위한 임의 커스텀 CSS --&gt;
&lt;link rel="stylesheet" href="css/style.css"&gt;
</code></pre></div></div>

<hr />

<p>그다음 지도가 표출될 엘리먼트를 만들어 줍시다.</p>

<p>index.html 파일 body 부분에 아래 코드를 추가해줍니다.</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;body&gt;
    &lt;div id="map"&gt;&lt;/div&gt;
 
    &lt;script src="js/map.js"&gt;&lt;/script&gt;
&lt;/body&gt;
</code></pre></div></div>

<hr />

<p>이제 처음 생성해두었던 [JS] 폴더에 map.js 파일을 생성합니다.</p>

<p>js/map.js</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/* js/map.js */

var map = new ol.Map({
    var map = new ol.Map({
        target: 'map',  // 위 index.html에 div id가 map인 엘리먼트에 맵을 표출
        layers: [
          new ol.layer.Tile({
            source: new ol.source.OSM()
          })
        ],
        view: new ol.View({
          center: ol.proj.fromLonLat([37.41, 8.82]),  // 맵이 로딩되었을 때 보여질 기본 위치(좌표) 설정
          zoom: 4  // 줌 레벨은 말 그대로 확대 레벨 (숫자가 커질수록 확대 됨)
        })
    });
});
</code></pre></div></div>

<hr />

<p>자 이제 거의다 왔습니다.</p>

<p>다음은 [CSS] 폴더 안에 style.css 파일을 생성 한 뒤 아래와 같이 작성해줍시다.</p>

<p>css/style.css</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/* css/style.css */
#map {
    width: 100%; // 지도 가로길이
    height: 500px;  // 지도 세로길이
}
</code></pre></div></div>

<p>이렇게 Openlayers맵을 띄우기 위한 준비가 끝났습니다.</p>

<p>모든 파일을 저장하시고 페이지를 새로고침 해봅시다.</p>

<p><img src="/assets/191118/1.png" /></p>

<p>잘 적용이 되었나요?</p>

<p>저와 같이 대한민국을 센터로 지정하고 싶으시면</p>

<p>Map.js 에 center 부분을 아래와 같이 바꿔주시면 됩니다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>js/map.js

var map = new ol.Map({
    var map = new ol.Map({
        target: 'map', 
        layers: [
          new ol.layer.Tile({
            source: new ol.source.OSM()
          })
        ],
        view: new ol.View({
            center: ol.proj.fromLonLat([129, 35.5]),
            zoom: 4
        })
    });
});

</code></pre></div></div>

<p>이상으로 오픈레이어(Openlayers) 시작하기 포스팅을 마무리하도록 하겠습니다.</p>

<p>감사합니다.</p>
:ET